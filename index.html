<html>
  <head>
    <title>Woflow Test</title>
  </head>
  <body>
    <p>Unique IDS: <span id="unique-cnt">...</span></p>
    <p>Max Occ: <span id="max-cnt">...</span></p>
    <p>Max ID: <span id="max-id">...</span></p>

    <script>
      const recursiveApi = (base_url, parent_ids, tree_obj, max_occ) => {
        max_occ  = max_occ || { "val": 0 }
        const new_parent_ids = []

        Promise.all( parent_ids.map( p_id => fetch( `${base_url}${p_id}` ) ) )
                .then( res => Promise.all( res.map( val=> val.json() ) ) )
                .then( data => {
                  data.forEach( records => {
                    records.forEach( record => {
                      record.child_node_ids.forEach( child => {
                        if ( child in tree_obj ) {
                          tree_obj[child]++
                          if (max_occ.val < tree_obj[child]) max_occ = { "id": child,  "val": tree_obj[child] }
                        } else {
                          tree_obj[child] = 1
                          new_parent_ids.push(child)
                        }
                      })
                    })
                  })
                  
                  if (new_parent_ids.length) recursiveApi(base_url, new_parent_ids, tree_obj, max_occ)
                  else {
                    document.getElementById('unique-cnt').innerHTML = Object.keys(tree_obj).length + 1 // for root
                    document.getElementById('max-cnt').innerHTML    = max_occ.val
                    document.getElementById('max-id').innerHTML     = max_occ.id
                  }
                })
      }

      const base_url  = "https://nodes-on-nodes-challenge.herokuapp.com/nodes/"
      const root_node = "089ef556-dfff-4ff2-9733-654645be56fe"
      // tree_obj initial state could be done here or in the initial method similar to max_occ
      recursiveApi( base_url, [root_node], {}, {"val": 1 } )
    </script>
  </body>
</html>